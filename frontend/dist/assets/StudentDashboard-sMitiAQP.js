var e=(e,s,r)=>new Promise((i,l)=>{var n=e=>{try{a(r.next(e))}catch(s){l(s)}},t=e=>{try{a(r.throw(e))}catch(s){l(s)}},a=e=>e.done?i(e.value):Promise.resolve(e.value).then(n,t);a((r=r.apply(e,s)).next())});import{u as s,j as r,A as i,R as l,b as n,d as t}from"./index-nVrMVh79.js";import{r as a}from"./react-vendor-Ct6ux_Fb.js";import{u as o}from"./router-BjWxKEch.js";import{I as d,_ as x,F as c,L as p,d as m,T as h,B as g,R as u,b as j,a as y,c as f,k as b,l as v,U as k,s as z,S,m as B,f as C,g as w,n as R,A as F,o as I}from"./antd-DWkf5yY6.js";import{R as T}from"./ArrowLeftOutlined-BaCjY7kl.js";import{R as _}from"./SaveOutlined-hbZEYkY4.js";import"./axios-DpZCZaHO.js";var W={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-260 72h96v209.9L621.5 312 572 347.4V136zm220 752H232V136h280v296.9c0 3.3 1 6.6 3 9.3a15.9 15.9 0 0022.3 3.7l83.8-59.9 81.4 59.4c2.7 2 6 3.1 9.4 3.1 8.8 0 16-7.2 16-16V136h64v752z"}}]},name:"book",theme:"outlined"},E=function(e,s){return a.createElement(d,x({},e,{ref:s,icon:W}))},A=a.forwardRef(E),L={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M877.1 238.7L770.6 132.3c-13-13-30.4-20.3-48.8-20.3s-35.8 7.2-48.8 20.3L558.3 246.8c-13 13-20.3 30.5-20.3 48.9 0 18.5 7.2 35.8 20.3 48.9l89.6 89.7a405.46 405.46 0 01-86.4 127.3c-36.7 36.9-79.6 66-127.2 86.6l-89.6-89.7c-13-13-30.4-20.3-48.8-20.3a68.2 68.2 0 00-48.8 20.3L132.3 673c-13 13-20.3 30.5-20.3 48.9 0 18.5 7.2 35.8 20.3 48.9l106.4 106.4c22.2 22.2 52.8 34.9 84.2 34.9 6.5 0 12.8-.5 19.2-1.6 132.4-21.8 263.8-92.3 369.9-198.3C818 606 888.4 474.6 910.4 342.1c6.3-37.6-6.3-76.3-33.3-103.4zm-37.6 91.5c-19.5 117.9-82.9 235.5-178.4 331s-213 158.9-330.9 178.4c-14.8 2.5-30-2.5-40.8-13.2L184.9 721.9 295.7 611l119.8 120 .9.9 21.6-8a481.29 481.29 0 00285.7-285.8l8-21.6-120.8-120.7 110.8-110.9 104.5 104.5c10.8 10.8 15.8 26 13.3 40.8z"}}]},name:"phone",theme:"outlined"},V=function(e,s){return a.createElement(d,x({},e,{ref:s,icon:L}))},O=a.forwardRef(V);const{Title:P,Text:q,Paragraph:H}=h,{Content:$}=p,{Option:M}=f,{TextArea:U}=y;function D(){var d,x,h,W;const{user:E,student:L,logout:V,updateProfile:D}=s(),J=o(),[N,G]=a.useState(!1),[K,Q]=a.useState(!1),[X,Y]=a.useState(L),[Z]=c.useForm(),[ee,se]=a.useState([]),[re,ie]=a.useState([]),[le,ne]=a.useState([]),[te,ae]=a.useState(""),[oe,de]=a.useState(""),[xe,ce]=a.useState(null);a.useEffect(()=>{Y(L),L&&(ie(L.skills||[]),ne(L.interests||[]))},[L]),a.useEffect(()=>{(()=>{e(this,null,function*(){try{const e=yield t.getUniversities();se(e.results||[])}catch(e){}})})()},[]),a.useEffect(()=>{var e,s,r;X&&K&&Z.setFieldsValue({first_name:null==(e=X.user)?void 0:e.first_name,last_name:null==(s=X.user)?void 0:s.last_name,email:null==(r=X.user)?void 0:r.email,university:X.university,course:X.course,specialization:X.specialization,phone:X.phone,bio:X.bio})},[X,K,Z]);const pe=()=>{te.trim()&&!re.includes(te.trim())&&(ie([...re,te.trim()]),ae(""))},me=()=>{oe.trim()&&!le.includes(oe.trim())&&(ne([...le,oe.trim()]),de(""))};return X?r.jsxs(p,{style:{minHeight:"100vh",background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)"},children:[r.jsx(i,{}),r.jsx($,{style:{padding:"40px 24px"},children:r.jsxs("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:[r.jsx(g,{icon:r.jsx(T,{}),onClick:()=>J("/"),size:"large",style:{marginBottom:"32px",borderRadius:"12px",height:"48px",fontWeight:"600",background:"linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.7) 100%)",border:"1px solid rgba(255, 255, 255, 0.3)",color:"#667eea",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)",backdropFilter:"blur(10px)"},children:"Назад к главной"}),r.jsxs("div",{style:{textAlign:"center",marginBottom:"48px"},children:[r.jsx(P,{level:1,style:{margin:"0 0 16px 0",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",fontSize:"48px",fontWeight:"800"},children:"Личный кабинет"}),r.jsx(q,{type:"secondary",style:{fontSize:"18px"},children:"Управляйте своим профилем и настройками"})]}),r.jsx(m,{style:{marginBottom:"32px",borderRadius:"24px",background:"linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.7) 100%)",backdropFilter:"blur(10px)",border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1)"},styles:{body:{padding:"40px"}},children:K?r.jsxs(c,{form:Z,layout:"vertical",onFinish:s=>e(this,null,function*(){var e,r,i;G(!0);try{const e=new FormData;Object.keys(s).forEach(r=>{"resume"!==r&&void 0!==s[r]&&e.append(r,s[r])}),xe&&xe instanceof File?e.append("resume",xe):null===s.resume&&e.append("resume",""),e.append("skills",JSON.stringify(re)),e.append("interests",JSON.stringify(le));const r=yield D(e);Y(r.student),Q(!1),ce(null),z.success("Профиль обновлен успешно!")}catch(l){if(null==(r=null==(e=l.response)?void 0:e.data)?void 0:r.error)z.error(l.response.data.error);else if(null==(i=l.response)?void 0:i.data){const e=l.response.data;"object"==typeof e&&Object.keys(e).forEach(s=>{Array.isArray(e[s])?z.error(`${s}: ${e[s].join(", ")}`):z.error(`${s}: ${e[s]}`)})}else z.error("Ошибка при обновлении профиля. Попробуйте еще раз.")}finally{G(!1)}}),size:"large",children:[r.jsxs("div",{style:{textAlign:"center",marginBottom:"40px"},children:[r.jsx(P,{level:2,style:{margin:"0 0 16px 0",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",fontSize:"32px",fontWeight:"700"},children:"Редактирование профиля"}),r.jsx(q,{type:"secondary",style:{fontSize:"16px"},children:"Измените информацию о себе"})]}),r.jsxs(u,{gutter:[16,0],children:[r.jsx(j,{xs:24,sm:12,children:r.jsx(c.Item,{name:"first_name",label:"Имя",rules:[{required:!0,message:"Введите имя"}],children:r.jsx(y,{prefix:r.jsx(l,{}),placeholder:"Имя"})})}),r.jsx(j,{xs:24,sm:12,children:r.jsx(c.Item,{name:"last_name",label:"Фамилия",rules:[{required:!0,message:"Введите фамилию"}],children:r.jsx(y,{placeholder:"Фамилия"})})})]}),r.jsx(c.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Введите email"},{type:"email",message:"Некорректный email"}],children:r.jsx(y,{prefix:r.jsx(n,{}),placeholder:"email@example.com"})}),r.jsxs(u,{gutter:[16,0],children:[r.jsx(j,{xs:24,sm:12,children:r.jsx(c.Item,{name:"university",label:"Учебное заведение",rules:[{required:!0,message:"Выберите учебное заведение"}],children:r.jsx(f,{placeholder:"Выберите учебное заведение",children:ee.map(e=>r.jsx(M,{value:e.id,children:e.name},e.id))})})}),r.jsx(j,{xs:24,sm:12,children:r.jsx(c.Item,{name:"course",label:"Курс",rules:[{required:!0,message:"Выберите курс"}],children:r.jsxs(f,{placeholder:"Выберите курс",children:[r.jsx(M,{value:1,children:"1 курс"}),r.jsx(M,{value:2,children:"2 курс"}),r.jsx(M,{value:3,children:"3 курс"}),r.jsx(M,{value:4,children:"4 курс"}),r.jsx(M,{value:5,children:"5 курс"}),r.jsx(M,{value:6,children:"6 курс"})]})})})]}),r.jsx(c.Item,{name:"specialization",label:"Специализация",children:r.jsx(y,{prefix:r.jsx(A,{}),placeholder:"Например: Программирование"})}),r.jsx(c.Item,{name:"phone",label:"Телефон",children:r.jsx(y,{prefix:r.jsx(O,{}),placeholder:"+7 (999) 123-45-67"})}),r.jsx(c.Item,{name:"bio",label:"О себе",children:r.jsx(U,{rows:3,placeholder:"Расскажите о себе, своих интересах и целях..."})}),r.jsx(c.Item,{name:"resume",label:"Резюме",children:r.jsxs("div",{children:[X.resume&&!xe&&r.jsx("div",{style:{marginBottom:"16px",padding:"12px",background:"#f0f9ff",borderRadius:"8px",border:"1px solid #e6f7ff"},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[r.jsx(b,{style:{marginRight:"8px",color:"#1890ff"}}),r.jsxs("div",{children:[r.jsx("div",{style:{fontWeight:"500",color:"#1890ff"},children:"Резюме загружено"}),r.jsx("div",{style:{fontSize:"12px",color:"#666"},children:X.resume.split("/").pop()})]})]}),r.jsxs("div",{style:{display:"flex",gap:"8px"},children:[r.jsx(g,{type:"link",icon:r.jsx(b,{}),onClick:()=>{const e=document.createElement("a");e.href=X.resume,e.download="resume.pdf",e.target="_blank",document.body.appendChild(e),e.click(),document.body.removeChild(e)},children:"Скачать"}),r.jsx(g,{type:"link",danger:!0,icon:r.jsx(v,{}),onClick:()=>{Z.setFieldsValue({resume:null}),ce(null)},children:"Удалить"})]})]})}),xe&&r.jsx("div",{style:{marginBottom:"16px",padding:"12px",background:"#f5f5f5",borderRadius:"8px"},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[r.jsx(b,{style:{marginRight:"8px",color:"#1890ff"}}),r.jsx("span",{style:{fontWeight:"500"},children:xe.name}),r.jsxs("span",{style:{marginLeft:"8px",color:"#666",fontSize:"12px"},children:["(",(xe.size/1024/1024).toFixed(2)," MB)"]})]}),r.jsx(g,{type:"link",danger:!0,icon:r.jsx(v,{}),onClick:()=>{ce(null),Z.setFieldsValue({resume:null})},children:"Удалить"})]})}),r.jsx(k,{name:"resume",beforeUpload:e=>{const s="application/pdf"===e.type,r="application/msword"===e.type||"application/vnd.openxmlformats-officedocument.wordprocessingml.document"===e.type;if(!s&&!r)return z.error("Можно загружать только PDF или DOC файлы!"),!1;if(!(e.size/1024/1024<5))return z.error("Размер файла должен быть меньше 5MB!"),!1;const i=new File([e],e.name,{type:e.type});return ce(i),Z.setFieldsValue({resume:i}),!1},showUploadList:!1,children:r.jsx(g,{icon:r.jsx(b,{}),children:xe?"Изменить резюме":X.resume?"Заменить резюме":"Загрузить резюме"})})]})}),r.jsxs(c.Item,{label:"Навыки",children:[r.jsx("div",{style:{marginBottom:"8px"},children:r.jsxs(S.Compact,{style:{width:"100%"},children:[r.jsx(y,{placeholder:"Добавить навык",value:te,onChange:e=>ae(e.target.value),onPressEnter:pe}),r.jsx(g,{type:"primary",icon:r.jsx(B,{}),onClick:pe,style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none"},children:"Добавить"})]})}),r.jsx("div",{children:re.map((e,s)=>r.jsx(C,{closable:!0,onClose:()=>{return s=e,void ie(re.filter(e=>e!==s));var s},color:"blue",style:{marginBottom:"4px"},children:e},s))})]}),r.jsxs(c.Item,{label:"Интересы",children:[r.jsx("div",{style:{marginBottom:"8px"},children:r.jsxs(S.Compact,{style:{width:"100%"},children:[r.jsx(y,{placeholder:"Добавить интерес",value:oe,onChange:e=>de(e.target.value),onPressEnter:me}),r.jsx(g,{type:"primary",icon:r.jsx(B,{}),onClick:me,style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none"},children:"Добавить"})]})}),r.jsx("div",{children:le.map((e,s)=>r.jsx(C,{closable:!0,onClose:()=>{return s=e,void ne(le.filter(e=>e!==s));var s},color:"green",style:{marginBottom:"4px"},children:e},s))})]}),r.jsx(w,{style:{margin:"32px 0"}}),r.jsx("div",{style:{textAlign:"center"},children:r.jsxs(S,{size:"large",children:[r.jsx(g,{type:"primary",htmlType:"submit",loading:N,icon:r.jsx(_,{}),size:"large",style:{borderRadius:"12px",height:"48px",paddingLeft:"32px",paddingRight:"32px",fontWeight:"600",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",boxShadow:"0 4px 12px rgba(102, 126, 234, 0.3)"},children:"Сохранить изменения"}),r.jsx(g,{icon:r.jsx(R,{}),onClick:()=>{var e,s,r;Q(!1),ce(null),X&&(Z.setFieldsValue({first_name:null==(e=X.user)?void 0:e.first_name,last_name:null==(s=X.user)?void 0:s.last_name,email:null==(r=X.user)?void 0:r.email,university:X.university,course:X.course,specialization:X.specialization,phone:X.phone,bio:X.bio}),ie(X.skills||[]),ne(X.interests||[]))},size:"large",style:{borderRadius:"12px",height:"48px",paddingLeft:"32px",paddingRight:"32px",fontWeight:"600"},children:"Отмена"})]})})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{textAlign:"center",marginBottom:"40px"},children:[r.jsx(F,{size:120,icon:r.jsx(l,{}),style:{backgroundColor:"#667eea",marginBottom:"24px",boxShadow:"0 8px 24px rgba(102, 126, 234, 0.3)"}}),r.jsxs(P,{level:2,style:{margin:"0 0 8px 0",color:"#2c3e50"},children:[null==(d=X.user)?void 0:d.first_name," ",null==(x=X.user)?void 0:x.last_name]}),r.jsxs(q,{type:"secondary",style:{fontSize:"18px"},children:["@",null==(h=X.user)?void 0:h.username]})]}),r.jsxs(u,{gutter:[32,32],children:[r.jsx(j,{xs:24,lg:12,children:r.jsxs("div",{style:{marginBottom:"24px"},children:[r.jsxs(q,{strong:!0,style:{color:"#667eea",fontSize:"16px"},children:[r.jsx(n,{style:{marginRight:"12px"}}),"Email:"]}),r.jsx("br",{}),r.jsx(q,{style:{fontSize:"16px",marginTop:"8px",display:"block"},children:(null==(W=X.user)?void 0:W.email)||"Не указан"})]})}),r.jsx(j,{xs:24,lg:12,children:r.jsxs("div",{style:{marginBottom:"24px"},children:[r.jsxs(q,{strong:!0,style:{color:"#667eea",fontSize:"16px"},children:[r.jsx(O,{style:{marginRight:"12px"}}),"Телефон:"]}),r.jsx("br",{}),r.jsx(q,{style:{fontSize:"16px",marginTop:"8px",display:"block"},children:X.phone||"Не указан"})]})})]}),r.jsxs(u,{gutter:[32,32],children:[r.jsx(j,{xs:24,lg:12,children:r.jsxs("div",{style:{marginBottom:"24px"},children:[r.jsxs(q,{strong:!0,style:{color:"#667eea",fontSize:"16px"},children:[r.jsx(A,{style:{marginRight:"12px"}}),"Учебное заведение:"]}),r.jsx("br",{}),r.jsx(q,{style:{fontSize:"16px",marginTop:"8px",display:"block"},children:X.university_name||"Не указан"})]})}),r.jsx(j,{xs:24,lg:12,children:r.jsxs("div",{style:{marginBottom:"24px"},children:[r.jsx(q,{strong:!0,style:{color:"#667eea",fontSize:"16px"},children:"Курс:"}),r.jsx("br",{}),r.jsx(q,{style:{fontSize:"16px",marginTop:"8px",display:"block"},children:X.course?`${X.course} курс`:"Не указан"})]})})]}),X.specialization&&r.jsxs("div",{style:{marginBottom:"24px"},children:[r.jsx(q,{strong:!0,style:{color:"#667eea",fontSize:"16px"},children:"Специализация:"}),r.jsx("br",{}),r.jsx(q,{style:{fontSize:"16px",marginTop:"8px",display:"block"},children:X.specialization})]}),X.bio&&r.jsxs("div",{style:{marginBottom:"24px"},children:[r.jsx(q,{strong:!0,style:{color:"#667eea",fontSize:"16px"},children:"О себе:"}),r.jsx("br",{}),r.jsx(H,{style:{marginTop:"8px",fontSize:"16px",lineHeight:"1.6"},children:X.bio})]}),X.resume&&r.jsxs("div",{style:{marginBottom:"24px"},children:[r.jsx(q,{strong:!0,style:{color:"#667eea",fontSize:"16px"},children:"Резюме:"}),r.jsx("br",{}),r.jsx("div",{style:{marginTop:"8px"},children:r.jsx(g,{type:"primary",icon:r.jsx(b,{}),onClick:()=>{const e=document.createElement("a");e.href=X.resume,e.download="resume.pdf",e.target="_blank",document.body.appendChild(e),e.click(),document.body.removeChild(e)},style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",borderRadius:"8px",height:"40px",fontSize:"14px",fontWeight:"500"},children:"Скачать резюме"})})]}),X.skills&&X.skills.length>0&&r.jsxs("div",{style:{marginBottom:"24px"},children:[r.jsx(q,{strong:!0,style:{color:"#667eea",fontSize:"16px"},children:"Навыки:"}),r.jsx("br",{}),r.jsx("div",{style:{marginTop:"8px"},children:X.skills.map((e,s)=>r.jsx(C,{color:"blue",style:{marginBottom:"8px",padding:"4px 12px",fontSize:"14px",borderRadius:"8px"},children:e},s))})]}),X.interests&&X.interests.length>0&&r.jsxs("div",{style:{marginBottom:"32px"},children:[r.jsx(q,{strong:!0,style:{color:"#667eea",fontSize:"16px"},children:"Интересы:"}),r.jsx("br",{}),r.jsx("div",{style:{marginTop:"8px"},children:X.interests.map((e,s)=>r.jsx(C,{color:"green",style:{marginBottom:"8px",padding:"4px 12px",fontSize:"14px",borderRadius:"8px"},children:e},s))})]}),r.jsx(w,{style:{margin:"32px 0"}}),r.jsx("div",{style:{textAlign:"center"},children:r.jsx(g,{type:"primary",icon:r.jsx(I,{}),onClick:()=>{Q(!0)},size:"large",style:{borderRadius:"12px",height:"48px",paddingLeft:"32px",paddingRight:"32px",fontWeight:"600",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",boxShadow:"0 4px 12px rgba(102, 126, 234, 0.3)"},children:"Редактировать профиль"})})]})})]})})]}):r.jsxs(p,{style:{minHeight:"100vh",background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)"},children:[r.jsx(i,{}),r.jsx($,{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"40px 24px"},children:r.jsxs(m,{style:{textAlign:"center",maxWidth:"400px"},children:[r.jsx(P,{level:3,children:"Профиль не найден"}),r.jsx(q,{type:"secondary",children:"Данные пользователя не загружены"})]})})]})}export{D as default};
